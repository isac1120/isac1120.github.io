<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta property="og:url" content="https://isac1120.github.io/" />
    <meta property="og:type" content="website" />
    <meta
      property="og:title"
      content="레이더스 큐브 - 로아 공대/파티 시너지 시뮬레이터"
    />
    <meta
      property="og:description"
      content="'레이더스 큐브'는 로스트아크 게임의, 공대/파티 시너지 조합 시뮬레이터입니다. 공대나 파티를 구성할 때, 시너지 조합이 힘든 로아 유저들을 위해 제작되었습니다."
    />
    <meta
      property="og:image"
      content="https://isac1120.github.io/website image synergy.png"
    />
    <meta property="og:site_name" content="레이더스 큐브" />
    <meta property="og:locale" content="en_US" />
    <meta name="Title" content="레이더스 큐브" />
    <meta
      name="Description"
      content="'레이더스 큐브'는 로스트아크 게임의, 공대/파티 시너지 조합 시뮬레이터입니다. 공대나 파티를 구성할 때, 시너지 조합이 힘든 로아 유저들을 위해 제작되었습니다."
    />
    <meta
      name="Keywords"
      content="raiders cube,로아,로스트아크,시너지,시너지표,공대장,공대,파티,시너지 조합,파티 시너지,공대 시너지,조합,레이더스 큐브,시뮬레이터,레이더스큐브"
    />
    <meta
      name="google-site-verification"
      content="yaUkKYCiVab6JzqQot32mvHsHdLC1XGTu2oBjYX8RHg"
    />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>레이더스 큐브 - 로아 공대/파티 시너지 시뮬레이터</title>

    <link rel="icon" type="image/icon" href="favicon.ico" />
    <link rel="shortcut icon" type="image/icon" href="favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png" />
    <link rel="manifest" href="site.webmanifest" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Jua&display=swap"
      rel="stylesheet"
    />
    <style>
      /* For Webkit browsers (Chrome, Safari, etc.) */
      ::-webkit-scrollbar {
        width: 15px; /* Increase the width of the vertical scrollbar */
        height: 20px; /* Increase the height of the horizontal scrollbar */
      }

      ::-webkit-scrollbar-thumb {
        background-color: #888;
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background-color: #555;
      }

      .title {
        min-width: 320px;
        border: 1px solid #ccc;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin: 1% auto;
        padding: 0.5% 0;
        width: 100%;
        height: 10%;
        background-color: #63c5da;
        font-family: "Jua", sans-serif;
      }

      body {
        font-family: "Jua", sans-serif;
        background-color: #f5f5f5;
      }

      .container {
        position: relative;
        width: 100%;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;

      }
      /* swithch */
      .switch-container {
        position: absolute;
        left: 0;
      }

      .switch {
        position: relative;
        display: inline-block;
        width: 120px;
        height: 28px;
      }

      .switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: red;
        transition: 0.4s;
      }

      .slider:before {
        position: absolute;
        content: "";
        height: 20px;
        width: 20px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: 0.4s;
      }

      input:checked + .slider {
        background-color: #2196f3;
      }

      input:focus + .slider {
        box-shadow: 0 0 1px #2196f3;
      }

      input:checked + .slider:before {
        transform: translateX(90px);
      }

      .on {
        display: none;
      }

      .on,
      .off {
        color: white;
        position: absolute;
        transform: translate(-50%, -50%);
        top: 50%;
        left: 50%;
        font-size: 10px;
        font-family: Verdana, sans-serif;
      }

      input:checked + .slider .on {
        display: block;
      }

      input:checked + .slider .off {
        display: none;
      }
      /*--------- END --------*/

      /* Rounded sliders */
      .slider.round {
        border-radius: 34px;
      }

      .slider.round:before {
        border-radius: 50%;
      }

      /* switch end*/

      .from-container {
        width: 66%;
        height: 700px;
      }
      .to-container {
        width: 33%;
        height: 700px;
      }

      .row {
        width: 100%;
      }

      .class-column,
      .synergy-column {
        min-height: 150px;
        min-width: 250px;
        overflow-y: auto;
        border: 1px solid #ccc;
        padding: 10px;
        margin: 20px;
        border-radius: 5px;
        background-color: #fff;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .class-column.draggable {
        width: 250px;
        height: 100px;
        padding: 15px;
        margin: 5px;
      }

      .class-column {
        min-height: 80px;
      }

      #class-columns,
      #synergy-columns {
        height: 650px;
        min-height: 300px;
        min-width: 300px;
        border: 1px solid #ccc;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(255, 156, 156, 0.1);
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
        white-space: nowrap;
      }

      #class-columns {
        min-width: 250px;
        flex-direction: column;
        flex-wrap: wrap;
        overflow-y: auto;
      }

      .container-header {
        display: flex;
        justify-content: center;
        min-width: 320px;
        width: 100%;
      }
      .rounded-rectangle {
        display: inline-block;
        background-color: #f00; /* Default color */
        color: #fff; /* Text color */
        border-radius: 10px; /* Adjust this value to change the roundness of the rectangle */
        padding: 5px 10px; /* Vertical and horizontal padding */
        margin: 5px; /* Space around each rectangle */
        font-size: 14px;
      }

      .grouping-columns {
        height: 650px;
        min-height: 250px;
        min-width: 300px;
        overflow-y: scroll;
        border: 1px solid #ccc;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .party-column {
        min-width: 250px;
        overflow-x: hidden;
        overflow-y: hidden;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin: 35px auto;
        padding: 10px 10px;
      }

      .user-column {
        min-width: 250px;
        min-height: 150px;
        overflow-y: auto;
        border: 1px solid #ccc;
        padding: 10px;
        margin: 20px;
        border-radius: 5px;
        background-color: #fff;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      #user-columns {
        height: 650px;
        min-height: 250px;
        min-width: 300px;
        display: flex;
        flex-direction: row;
        flex-wrap: nowrap;
        overflow-x: auto;
        overflow-y: auto;
        width: 100%;
        border: 1px solid #ccc;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .nickname-input {
        margin-right: 10px;
      }

      .submit-button {
        margin: 4% auto;
        background-color: #63c5da;
        border: none;
        color: #fff;
        padding: 5px 10px;
        border-radius: 3px;
        cursor: pointer;
      }

      .draggable,
      .droppable {
        border: 1px solid #ccc;
        padding: 5px 0;
        margin: 5px auto;
        border-radius: 3px;
        text-align: center;
        background-color: #f5f5f5;
      }

      .draggable {
        font-size: 15px;
        cursor: pointer;
      }

      .droppable {
        width: 100%;
        border: 1px solid #ccc;
        padding: 3px; /* Increase the padding */
        margin: 3px;
        border-radius: 3px;
        text-align: center;
        background-color: #f5f5f5;
        min-height: 30px; /* Increase the min-height */
      }

      button.delete {
        float: right;
        background-color: transparent;
        border: none;
        color: #f00;
        font-weight: bold;
      }

      .placeholder {
        border: 1px dashed #ccc;
        min-height: 50px;
        margin: 5px;
        background-color: rgba(0, 0, 0, 0.1);
      }
      .color-circle {
        display: inline-block;
        width: 15px;
        height: 15px;
        border-radius: 50%;
        margin: auto 5px;
      }
      .row.scrollable-row {
        overflow-x: hidden;
        white-space: nowrap;
      }
      .button-container {
        position: absolute;
        right: 0;
        
      }
      .copy-button,
      .save-button {
        font-size: 13px;
        background-color: #63c5da;
        border: none;
        color: #fff;
        padding: 5px 10px;
        border-radius: 3px;
        cursor: pointer;
      }
      @media (max-width: 1024px) {
        .from-container,
        .to-container {
          width: 100%;
          height: 350px;
          margin: 2%;
        }
        .draggable {
          width: 200px;
        }
        .class-column.draggable {
          min-width: 200px;
          width: 200px;
        }
        #synergy-columns,
        #class-columns,
        #user-columns,
        .grouping-columns {
          height: 300px;
        }

        .sidebar {
          height: 350px;
        }
        #sideOpenBtn {
          height: 350px;
        }
      }
      @media (max-width: 340px) {
        .container{
          width: 340px;
        }
        
        .from-container,
        .to-container {
          width: 100%;
          height: 350px;
          margin: 2%;
        }
        .draggable {
          width: 200px;
        }
        .class-column.draggable {
          min-width: 200px;
          width: 200px;
        }
        #synergy-columns,
        #class-columns,
        #user-columns,
        .grouping-columns {
          height: 300px;
        }
        .sidebar {
          height: 350px;
        }
        #sideOpenBtn {
          height: 350px;
        }
        
      }
      .handsontable .main-header{
        background-color:orangered;
      }
      .handsontable .sub-header{
        background-color:orange;
      }
      /* The side navigation menu */
      .sidebar {
        display: flex;
        justify-content: flex-start;
        align-items: flex-start;
        border-radius: 0 10px 10px 0;
        position: absolute;
        height: 650px; /* 100% Full-height */
        width: 0; /* 0 width - change this with JavaScript */
        padding-top: 20px;
        z-index: 1; /* Stay on top */
        background-color: grey; /* Black*/
        opacity: 95%;
        overflow-x: hidden; /* Disable horizontal scroll */
        transition: 0.5s; /* 0.5 second transition effect to slide in the sidenav */
      
      }
      #sideCloseBtn {
        width: 40px;
        height: 100%;
        padding: 0 10px;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      #sideCloseBtn:hover {
        
        background-color: #444;
      }
      #sideOpenBtn {
        display: flex;
        border-radius: 0 10px 10px 0;
        justify-content: center;
        align-items: center;
        width: 30px;
        height: 650px;
        background-color: grey;
        position: absolute;
        z-index: 1;
      }
      #sideOpenBtn:hover {
        background-color: #444;
      }
      #spreadsheet-container {
        width : 95%;
        padding: 10px 0 0 10px;
        height: 97%;
        overflow: auto;
      }

      #paste-button{
        position: relative;
        top: 3%;
        left: 35%;
        width: 80px;
        height: 30px;

      }

      /* Media query for mobile devices */
    </style>
  </head>
  <body>
    <div class="title text-center">
        <h2 class="d-inline ">공대 구성 시뮬레이터</h2>
        <h6 class="d-inline align-bottom">2023.07ver</h6>
    </div>
    <div id="sideOpenBtn" onclick="openBar()">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
      </svg>
    </div>
      <div id="table-sidebar" class="sidebar">
        <div id="sideCloseBtn" onclick="closeBar()">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
          </svg>
        </div>
        <div id="spreadsheet-container">
          <div class="container-header">
            <h4>레이드 시트</h4>
            <button id="paste-button" class="save-button">붙여넣기</button>
          </div>
          <div id="spreadsheet">
          </div>
        </div>

      </div>
    <div class="container">

      <div class="switch-container">
        <label class="switch">
          <input type="checkbox" class="togBtn" />
          <div class="slider round">
            <!-- Added changes here -->
            <span class="on">시너지순으로</span>
            <span class="off">클래스</span>
          </div>
        </label>
      </div>
      <div id="synergy-container" class="from-container">
        <div class="container-header">
          <h4 class="text-center">시너지</h4>
        </div>
        <div id="synergy-columns">
          <!-- Add your synergy columns here -->
        </div>
      </div>

      <div id="synergy-group-container" class="to-container">
        <div class="container-header">
          <div class="button-container">
            <button id="synergy-copyBtn" class="copy-button">복사</button>
            <button id="synergy-saveBtn" class="save-button">저장</button>
          </div>
          <h4 class="text-center">공대</h4>
        </div>
        <div id="synergy-group" class="grouping-columns">
          <!-- Add your grouping columns here -->
        </div>
      </div>

      <div id="class-container" class="from-container" style="display: none">
        <div class="container-header">
          <h4 class="text-center">클래스</h4>
        </div>
        <div id="class-columns">
          <!-- Add your class columns here -->
        </div>
      </div>

      <div
        id="class-group-container"
        class="to-container"
        style="display: none"
      >
        <div class="container-header">
          <div class="button-container">
            <button id="class-copyBtn" class="copy-button">복사</button>
            <button id="class-saveBtn" class="save-button">저장</button>
          </div>
          <h4 class="text-center">공대</h4>
        </div>
        <div id="class-group" class="grouping-columns">
          <!-- Add your grouping columns here -->
        </div>
      </div>

      <div id="user-container" class="from-container">
        <div class="container-header">
          <h4 class="text-center">유저</h4>
        </div>
        <div id="user-columns">
          <!-- Add your user columns here -->
        </div>
      </div>

      <div id="character-group-container" class="to-container">
        <div class="container-header">
          <div class="button-container">
            <button class="copy-button">복사</button>
            <button class="save-button">저장</button>
          </div>
          <h4 class="text-center">공대</h4>
        </div>
        <div id="character-group" class="grouping-columns">
          <!-- Add your grouping columns here -->
        </div>
      </div>
    </div>

    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-NY4TE8ZY84"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-NY4TE8ZY84");
    </script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/5.0.5/js/tabulator.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/5.0.5/css/tabulator.min.css"
    />
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.0/papaparse.min.js"></script>

    <script>
      $(document).ready(function () {
        // Synergy data
        var synergies = [
          {
            name: "치명타 적중률 증가",
            categories: [
              {
                categoryName: "상시10%",
                classes: ["건슬링어", "아르카나", "데빌헌터", "기상술사"],
                color: "#8B0000",
              },
              {
                categoryName: "순간18%",
                classes: ["스트라이커", "배틀마스터"],
                color: "#FF0000",
              },
            ],
            color: "#FF0000",
          },
          {
            name: "치명타시 받는 피해 증가",
            categories: [
              {
                categoryName: "상시8%",
                classes: ["창술사"],
                color: "#DB7093",
              }
            ]
          },        
          {
            name: "받는 피해 증가",
            categories: [
              {
                categoryName: "상시6%",
                classes: [
                  "소서리스",
                  "인파이터",
                  "호크아이",
                  "데모닉",
                  "버서커",
                  "블레이드",
                  "슬레이어",
                ],
                color: "#FF1493",
              },
              {
                categoryName: "상시3%",
                classes: ["워로드"],
                color: "#FF69B4",
              },
              {
                categoryName: "기타",
                classes: ["바드", "도화가", "홀리나이트"],
                color: "#FFC0CB",
              },
            ],
            color: "#FF1493",
          },
          {
            name: "방어력 감소",
            categories: [
              {
                categoryName: "상시12%",
                classes: [
                  "워로드",
                  "디스트로이어",
                  "블래스터",
                  "서머너",
                  "리퍼",
                ],
                color: "#8B4513",
              },
            ],
            color: "#8B4513",
          },
          {
            name: "공격력 증가",
            categories: [
              {
                categoryName: "상시6%",
                classes: ["기공사", "스카우터"],
                color: "#FF4500",
              },
              {
                categoryName: "기타",
                classes: ["바드", "도화가", "홀리나이트"],
                color: "#FF6347",
              },
            ],
            color: "#FF4500",
          },
          {
            name: "백헤드 피해 증가",
            categories: [
              {
                categoryName: "상시9%",
                classes: ["블레이드"],
                color: "#BDB76B",
              },
              {
                categoryName: "순간9%",
                classes: ["워로드"],
                color: "#FFFF00",
              },
            ],
            color: "#FFFF00",
          },
          {
            name: "공격력 감소",
            categories: [
              {
                categoryName: "여우비상태10%",
                classes: ["[이슬비]기상술사"],
                color: "#00BFFF",
              },
            ],
            color: "#00BFFF",
          },
          {
            name: "피해 감소 & 보호막",
            categories: [
              {
                categoryName: "딜러",
                classes: ["워로드", "기공사"],
                color: "#008B8B",
              },
              {
                categoryName: "서폿",
                classes: ["바드", "도화가", "홀리나이트"],
                color: "#00FFFF",
              },
            ],
            color: "#00FFFF",
          },
          {
            name: "무력화 피해 증가",
            categories: [
              {
                categoryName: "순간20%",
                classes: ["디스트로이어", "블래스터"],
                color: "#006400",
              },
            ],
            color: "#006400",
          },
          {
            name: "공격 속도 증가",
            categories: [
              {
                categoryName: "딜러",
                classes: [
                  "배틀마스터",
                  "블레이드",
                  "스트라이커",
                  "[질풍]기상술사",
                ],
                color: "#800080",
              },
              {
                categoryName: "서폿",
                classes: ["바드", "도화가"],
                color: "#9370DB",
              },
            ],
            color: "#9370DB",
          },
          {
            name: "이동 속도 증가",
            categories: [
              {
                categoryName: "딜러",
                classes: [
                  "배틀마스터",
                  "블레이드",
                  "[두동]호크아이",
                  "[질풍]기상술사",
                ],
                color: "#FFE4E1",
              },
              {
                categoryName: "서폿",
                classes: ["도화가", "홀리나이트"],
                color: "#FFFFF0",
              },
            ],
            color: "FFFFF0",
          },
          {
            name: "정화",
            categories: [
              {
                categoryName: "딜러",
                classes: ["워로드", "기공사"],
                color: "#2F4F4F",
              },
              {
                categoryName: "서폿",
                classes: ["도화가", "홀리나이트"],
                color: "#696969",
              },
            ],
            color: "#2F4F4F",
          },
          {
            name: "체력 & 마나 회복",
            categories: [
              {
                categoryName: "딜러",
                classes: ["서머너"],
                color: "#778899",
              },
              {
                categoryName: "서폿",
                classes: ["바드", "도화가", "홀리나이트"],
                color: "#DCDCDC",
              },
            ],
            color: "#DCDCDC",
          },
        ];

        // Create synergy columns
        synergies.forEach(function (synergy) {
          var column = $('<div class="synergy-column"></div>').css(
            "background-color",
            "#fff"
          ); /* Change the background color to white */
          var header = $("<h5></h5>").text(synergy.name);
          column.append(header);

          synergy.categories.forEach(function (category) {
            var categoryName = category.categoryName;
            var categoryHeader = $("<h6></h6>").text(categoryName);
            var subColumn = $("<div></div>");
            subColumn.append(categoryHeader);

            category.classes.forEach(function (className) {
              var element = $("<div></div>")
                .text(className)
                .addClass("draggable")
                .css("background-color", category.color);
              /* Add the .class-element class and set the background color */
              subColumn.append(element);
            });

            column.append(subColumn);
          });

          $("#synergy-columns").append(column);
        });

        // Create a dictionary to store class-centric data
        var classes = {};

        // Iterate over synergies to build the classes dictionary
        synergies.forEach(function (synergy) {
          synergy.categories.forEach(function (category) {
            category.classes.forEach(function (className) {
              // If class is not yet in the dictionary, add it
              // Remove any words in parentheses
              var baseClassName = className.replace(/\[.*\]/g, "").trim();

              if (!(className in classes)) {
                classes[className] = [];
              }
              // Add the synergy to the class
              classes[className].push({
                synergyName: synergy.name,
                categoryName: category.categoryName,
                color: category.color,
              });
            });
          });
        });

        // Iterate over synergies to build the classes dictionary
        synergies.forEach(function (synergy) {
          synergy.categories.forEach(function (category) {
            category.classes.forEach(function (className) {
              // If class is not yet in the dictionary, add it
              // Remove any words in parentheses
              var baseClassName = className.replace(/\[.*\]/g, "").trim();
              if (
                className.includes(baseClassName) &&
                className !== baseClassName
              ) {
                classes[className] = JSON.parse(
                  JSON.stringify(classes[baseClassName])
                );
                // Add the synergy to the class
                classes[className].push({
                  synergyName: synergy.name,
                  categoryName: category.categoryName,
                  color: category.color,
                });
              }
            });
          });
        });

        // Iterate over synergies to build the classes dictionary
        synergies.forEach(function (synergy) {
          synergy.categories.forEach(function (category) {
            category.classes.forEach(function (className) {
              // If class is not yet in the dictionary, add it
              // Remove any words in parentheses
              var baseClassName = className.replace(/\[.*\]/g, "").trim();
              if (
                className.includes(baseClassName) &&
                className !== baseClassName
              ) {
                delete classes[baseClassName];
              }
            });
          });
        });

        // Now you have a classes dictionary where each key is a class name and its value is an array of synergies

        // Create class columns
        Object.keys(classes).forEach(function (className) {
          var column = $('<div class="class-column"></div>')
            .text(className)
            .addClass("draggable")
            .css("background-color", "#fff");
          // Create a circle with the first letter of synergyName
          var wrapper = $("<div class='class-synergy'></div>");
          classes[className].forEach(function (synergy) {
            var initials = synergy.synergyName
              .split(" ")
              .map((word) => word.charAt(0).toUpperCase())
              .join("");

            var circle = $("<div></div>")
              .addClass("rounded-rectangle")
              .css("background-color", synergy.color)
              .text(initials);

            // Add tooltip attributes
            circle
              .attr({
                "data-toggle": "tooltip",
                "data-placement": "bottom",
                title: synergy.synergyName + "-" + synergy.categoryName,
              })
              .tooltip();

            wrapper.append(circle);
          });
          column.append(wrapper);
          // Append the column to the appropriate container
          $("#class-columns").append(column);
        });

        // Define your parties here
        var synergyGroup = ["1파티", "2파티"];

        // Create grouping columns
        synergyGroup.forEach(function (party, index) {
          var column = $('<div class="party-column col-10"></div>').css(
            "background-color",
            "#fff"
          );
          var header = $("<h6></h6>").text(party);
          column.append(header);

          for (var i = 0; i < 4; i++) {
            var element = $("<div></div>")
              .addClass("droppable")
              .css("min-height", "50px");
            column.append(element);
          }

          $("#synergy-group").append(column);
        });

        // Define your parties here
        var classGroup = ["1파티", "2파티"];

        // Create grouping columns
        classGroup.forEach(function (party, index) {
          var column = $('<div class="party-column col-10"></div>').css(
            "background-color",
            "#fff"
          );
          var header = $("<h6></h6>").text(party);
          var colorCount = $("<span></span>")
            .addClass("color-count")
            .css("font-size", "13px");
          header.append(colorCount);
          column.append(header);

          for (var i = 0; i < 4; i++) {
            var element = $("<div></div>")
              .addClass("droppable")
              .css("min-height", "50px");
            column.append(element);
          }

          $("#class-group").append(column);
        });

        // Draggable elements
        $("#synergy-columns .draggable").draggable({
          helper: "clone",
          revert: "invalid",
          appendTo: "body",
          zIndex: 100,
        });

        // Droppable elements
        $("#synergy-group .droppable").droppable({
          accept: "#synergy-columns .draggable",
          drop: function (event, ui) {
            var dropped = ui.helper.clone();
            dropped.removeClass("ui-draggable ui-draggable-handle");
            dropped.css({ position: "static", left: "", top: "" });
            // Add tooltips to the cloned draggable elements
            dropped.find("[data-toggle='tooltip']").tooltip();
            dropped.click(function () {
              dropped.find("[data-toggle='tooltip']").tooltip("hide");
              $(this).remove();
            });

            $(this).empty().append(dropped);
          },
        });

        // Sortable elements
        $("#synergy-group .grouping-columns")
          .sortable({
            connectWith: "#synergy-group .grouping-columns",
            items: ".droppable",
            placeholder: "placeholder",
            start: function (event, ui) {
              ui.item.addClass("dragging");

              ui.item.data("fromIndex", ui.item.index());
              ui.item.data("fromParent", ui.item.parent());
            },
            stop: function (event, ui) {
              ui.item.removeClass("dragging");

              ui.item.data("toIndex", ui.item.index());
              ui.item.data("toParent", ui.item.parent());

              var fromParent = ui.item.data("fromParent");
              var fromIndex = ui.item.data("fromIndex");
              var toParent = ui.item.data("toParent");
              var toIndex = ui.item.data("toIndex");

              if (fromParent[0] !== toParent[0]) {
                var fromChild = fromParent.children().eq(fromIndex);
                var toChild = toParent.children().eq(toIndex + 1);

                fromChild.before(toChild);
              }
            },
          })
          .disableSelection();

        // Draggable elements
        $("#class-columns .draggable").draggable({
          helper: "clone",
          revert: "invalid",
          appendTo: "body",
          zIndex: 100,
        });

        // Droppable elements
        $("#class-group .droppable").droppable({
          accept: "#class-columns .draggable",
          drop: function (event, ui) {
            var dropped = ui.helper.clone();
            dropped.removeClass("ui-draggable ui-draggable-handle");
            dropped.css({ position: "static", left: "", top: "" });
            // Add tooltips to the cloned draggable elements
            dropped.find("[data-toggle='tooltip']").tooltip();
            dropped.click(function () {
              dropped.find("[data-toggle='tooltip']").tooltip("hide");
              $(this).remove();
              updateClassPartyStats();
            });

            $(this).empty().append(dropped);
            updateClassPartyStats();
          },
        });

        // Sortable elements
        $("#class-group .grouping-columns")
          .sortable({
            connectWith: "#class-group .grouping-columns",
            items: ".droppable",
            placeholder: "placeholder",
            start: function (event, ui) {
              ui.item.addClass("dragging");

              ui.item.data("fromIndex", ui.item.index());
              ui.item.data("fromParent", ui.item.parent());
            },
            stop: function (event, ui) {
              ui.item.removeClass("dragging");

              ui.item.data("toIndex", ui.item.index());
              ui.item.data("toParent", ui.item.parent());

              var fromParent = ui.item.data("fromParent");
              var fromIndex = ui.item.data("fromIndex");
              var toParent = ui.item.data("toParent");
              var toIndex = ui.item.data("toIndex");

              if (fromParent[0] !== toParent[0]) {
                var fromChild = fromParent.children().eq(fromIndex);
                var toChild = toParent.children().eq(toIndex + 1);

                fromChild.before(toChild);
              }
            },
          })
          .disableSelection();

        function updateClassPartyStats() {
          $("#class-group .party-column").each(function (
            elementIndex,
            element
          ) {
            var totalItemLevel = 0;
            var itemCount = 0;
            var uniColor = [];
            var uniShortSyn = [];
            var uniSynergy = [];
            var uniData = [];

            //iterate every character element space.
            $(element)
              .find(".droppable")
              .each(function (ElementIndex, Element) {
                //check character element existence in a character element space.
                if ($(this).find(".draggable").length) {
                  //get class name of a characterElement
                  className = $(Element)[0].innerText.split("\n")[0];

                  //get other data of characterElement using className
                  var color = getColorForClass(className);
                  var synergy = getSynergyForClass(className);
                  var shortSyn = getShortSynergyForClass(className);

                  //add unique data in a party from each character element
                  color.forEach(function (item, index) {
                    uniColor.push(item);
                  });
                  synergy.forEach(function (item, index) {
                    uniSynergy.push(item);
                  });
                }
              });

            uniSynergy.forEach(function (item, index) {
              uniShortSyn.push(
                item
                  .split("-")[0]
                  .split(" ")
                  .map((word) => word.charAt(0).toUpperCase())
                  .join("")
              );
            });

            //rearrange uniData synergy in Korean alphabetical order
            for (var i = 0; i < uniColor.length; i++) {
              var data = {
                color: uniColor[i],
                shortSyn: uniShortSyn[i],
                synergy: uniSynergy[i],
              };
              uniData.push(data);
            }

            uniData.sort(function (a, b) {
              var synergyA = a.synergy.toUpperCase();
              var synergyB = b.synergy.toUpperCase();
              if (synergyA < synergyB) {
                return -1;
              }
              if (synergyA > synergyB) {
                return 1;
              }
              return 0;
            });

            //make partySynergy with tooltip
            $(this).find(".party-synergy").remove();
            var partySynergy = $("<div></div>")
              .addClass("party-synergy")
              .attr({ width: "100%" });
            var prevSynergy = "";
            for (var i = 0; i < Object.keys(uniData).length; i++) {
              if (
                uniData[i].synergy.split("-")[0] != prevSynergy.split("-")[0]
              ) {
                counter = 0;
              }
              counter++;
              var synergySymbol = $("<span></span>")
                .addClass("rounded-rectangle")
                .css("background-color", uniData[i].color);
              synergySymbol.text(uniData[i].shortSyn);
              synergySymbol
                .attr({
                  "data-toggle": "tooltip",
                  "data-placement": "bottom",
                  title: uniData[i].synergy,
                })
                .tooltip();
              // add '/' between colorCircles with successive same synergy
              if (
                i > 0 &&
                uniData[i].synergy.split("-")[0] != prevSynergy.split("-")[0]
              ) {
                partySynergy.append("<span> / </span>");
              }
              partySynergy.append(synergySymbol);
              prevSynergy = uniData[i].synergy;
            }

            //display party data except character data
            var numSlash = partySynergy.text().split("/").length - 1;

            //synergy number data
            if (numSlash == 0 && Object.keys(uniData).length == 0) {
              $(this)
                .find(".color-count")
                .text(
                  " 시너지수:" +
                    Object.keys(uniData).length +
                    " (" +
                    numSlash +
                    ")"
                );
            } else if (numSlash == 0 && Object.keys(uniData).length != 0) {
              numSlash++;
              $(this)
                .find(".color-count")
                .text(
                  " 시너지수:" +
                    Object.keys(uniData).length +
                    " (" +
                    numSlash +
                    ")"
                );
            } else {
              numSlash++;
              $(this)
                .find(".color-count")
                .text(
                  " 시너지수:" +
                    Object.keys(uniData).length +
                    " (" +
                    numSlash +
                    ")"
                );
            }
            //color circles
            $(this).find(".color-count").after(partySynergy);
          });
        }

        $(".togBtn").change(function () {
          if ($(this).is(":checked")) {
            // Hide synergiesContainer and show classesContainer when the slider is on the right
            $("#synergy-container").hide();
            $("#class-container").show();
            $("#synergy-group-container").hide();
            $("#class-group-container").show();
          } else {
            // Show synergiesContainer and hide classesContainer when the slider is on the left
            $("#synergy-container").show();
            $("#class-container").hide();
            $("#synergy-group-container").show();
            $("#class-group-container").hide();
          }
        });

        // Define user columns
        var users = [
          "유저 1",
          "유저 2",
          "유저 3",
          "유저 4",
          "유저 5",
          "유저 6",
          "유저 7",
          "유저 8",
        ];

        // Create user columns
        users.forEach(function (user) {
          var column = $('<div class="user-column col-5"></div>').css(
            "background-color",
            "#fff"
          );
          var header = $("<h5></h5>").text(user);
          var form = $(
            '<form><input type="text" class="nickname-input" placeholder="캐릭터 닉네임을 입력하세요"><button type="submit" class="submit-button">Submit</button></form>'
          );
          var container = $('<div class="character-container"></div>');
          column.append(header);
          column.append(form);
          column.append(container);
          $("#user-columns").append(column);

          // Handle form submission
          form.submit(function (event) {
            event.preventDefault();
            var nickname = $(this).find(".nickname-input").val();
            getCharacterData(nickname, container);
          });
        });

        function getCharacterData(nickname, container) {
          var url =
            "https://developer-lostark.game.onstove.com/characters/" +
            nickname +
            "/siblings";
          var xhr = new XMLHttpRequest();
          xhr.open("GET", url, true);
          xhr.setRequestHeader("accept", "application/json");
          xhr.setRequestHeader(
            "authorization",
            "bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IktYMk40TkRDSTJ5NTA5NWpjTWk5TllqY2lyZyIsImtpZCI6IktYMk40TkRDSTJ5NTA5NWpjTWk5TllqY2lyZyJ9.eyJpc3MiOiJodHRwczovL2x1ZHkuZ2FtZS5vbnN0b3ZlLmNvbSIsImF1ZCI6Imh0dHBzOi8vbHVkeS5nYW1lLm9uc3RvdmUuY29tL3Jlc291cmNlcyIsImNsaWVudF9pZCI6IjEwMDAwMDAwMDAxNzQ1MjAifQ.ZT_vbQ4k1kYAXqUGI4UyodNb1EYNE7hXJKA2wv8d9-nweEp6bpFzyFJK0zpL46Ic1zdnXo2fdlTCxfLd0l8NlZtVHSGMNL0FpViFUYvOed1h_Dm0J2LQb4q3dAtLFnSqGPJbHfa7h-uY5z0LN5RhIc7l9QFt4o7atVtfejVub7unMjM5ajZdfeIZxEbzUFzLQ5OtS1cpP6f3VY6_yK0w2_waf6ZnMKy_fVcWVjP5U3IsaxQ-ErG5iWYb9B6XA5swW_KUe2qOW4KG7D0dZRzYiGrkFi5eI87G6Mfv7EN5PJzSgTEa4bnzYlyvMcVuK6Hey00E1DWKca6L8na2nyACaw"
          );
          xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
              if (xhr.status === 200) {
                var response = JSON.parse(xhr.responseText);
                displayCharacterData(response, container);
              } else {
                console.log("Error:", xhr.statusText);
              }
            }
          };
          xhr.send();
        }

        function displayCharacterData(data, container) {
          container.empty();
          data.forEach(function (character) {
            var element = $("<div></div>")
              .text(
                character.CharacterName +
                  " (" +
                  character.CharacterClassName +
                  " " +
                  character.ItemAvgLevel +
                  ")"
              )
              .addClass("draggable")
              .css("background-color", "white");
            var color = getColorForClass(character.CharacterClassName);
            var synergy = getSynergyForClass(character.CharacterClassName);
            var shortSyn = getShortSynergyForClass(
              character.CharacterClassName
            );
            var wrapper = $("<div></div>");

            color.forEach(function (colorElement, index) {
              //make circle with colored corresponding to each class synergy
              var circle = $("<div></div>")
                .addClass("rounded-rectangle")
                .css("background-color", colorElement);
              circle.text(shortSyn[index]);
              circle
                .attr({
                  "data-toggle": "tooltip",
                  "data-placement": "bottom",
                  title: synergy[index],
                })
                .tooltip();

              wrapper.append(circle);
            });

            element.append(wrapper);
            container.append(element);
            element.draggable({
              helper: "clone",
              revert: "invalid",
              appendTo: "body",
              zIndex: 100,
            });
          });
        }

        // Define your parties here
        var characterGroup = ["1파티", "2파티"];
        // Create grouping columns
        characterGroup.forEach(function (party, index) {
          var column = $('<div class="party-column col-10"></div>').css(
            "background-color",
            "#fff"
          );
          var header = $("<h6></h6>").text(party);
          var avgItemLevel = $("<span></span>")
            .addClass("avg-item-level")
            .css("font-size", "13px");
          var colorCount = $("<span></span>")
            .addClass("color-count")
            .css("font-size", "13px");
          header.append(avgItemLevel, colorCount);
          column.append(header);

          for (var i = 0; i < 4; i++) {
            var element = $("<div></div>")
              .addClass("droppable")
              .css("min-height", "50px");
            column.append(element);
          }

          $("#character-group").append(column);
        });

        $("#character-group .droppable").droppable({
          accept: ".draggable",
          drop: function (event, ui) {
            var dropped = ui.helper.clone();
            dropped.removeClass("ui-draggable ui-draggable-handle");
            dropped.css({ position: "static", left: "", top: "" });
            // Add tooltips to the cloned draggable elements
            dropped.find("[data-toggle='tooltip']").tooltip();

            dropped.click(function () {
              dropped.find("[data-toggle='tooltip']").tooltip("hide");
              $(this).remove();
              updateCharacterPartyStats();
            });

            $(this).empty().append(dropped);
            updateCharacterPartyStats();
          },
        });

        $("#character-group")
          .sortable({
            connectWith: "#character-group",
            items: ".droppable",
            placeholder: "placeholder",
            appendTo: "body",
            helper: "clone",
            start: function (event, ui) {
              ui.item.addClass("dragging");
              ui.item.data("fromIndex", ui.item.index());
              ui.item.data("fromParent", ui.item.parent());
            },
            stop: function (event, ui) {
              ui.item.removeClass("dragging");
              ui.item.data("toIndex", ui.item.index());
              ui.item.data("toParent", ui.item.parent());
              var fromParent = ui.item.data("fromParent");
              var fromIndex = ui.item.data("fromIndex");
              var toParent = ui.item.data("toParent");
              var toIndex = ui.item.data("toIndex");

              if (fromParent[0] !== toParent[0]) {
                var fromChild = fromParent.children().eq(fromIndex);
                var toChild = toParent.children().eq(toIndex + 1);

                fromChild.before(toChild);
              }
              updateCharacterPartyStats();
            },
          })
          .disableSelection();

        function getColorForClass(className) {
          var classColor = [];
          synergies.forEach(function (synergy) {
            synergy.categories.forEach(function (category) {
              category.classes.forEach(function (classType) {
                if (classType.includes(className)) {
                  classColor.push(category.color);
                }
              });
            });
          });
          return classColor;
        }

        function getSynergyForClass(className) {
          var classSynergy = [];
          synergies.forEach(function (synergy) {
            synergy.categories.forEach(function (category) {
              category.classes.forEach(function (classType) {
                if (classType.includes(className)) {
                  classSynergy.push(
                    synergy.name + " - " + category.categoryName
                  );
                }
              });
            });
          });
          return classSynergy;
        }
        function getShortSynergyForClass(className) {
          var classSynergy = [];
          synergies.forEach(function (synergy) {
            synergy.categories.forEach(function (category) {
              category.classes.forEach(function (classType) {
                if (classType.includes(className)) {
                  // var shortenedName = synergy.name.split(" ")[0].charAt(0);
                  var shortenedName = synergy.name
                    .split(" ")
                    .map((word) => word.charAt(0).toUpperCase())
                    .join("");

                  classSynergy.push(shortenedName);
                }
              });
            });
          });
          return classSynergy;
        }

        function updateCharacterPartyStats() {
          $("#character-group .party-column").each(function (
            elementIndex,
            element
          ) {
            var totalItemLevel = 0;
            var itemCount = 0;
            var uniColor = [];
            var uniShortSyn = [];
            var uniSynergy = [];
            var uniData = [];

            //iterate every character element space.
            $(element)
              .find(".droppable")
              .each(function (ElementIndex, Element) {
                //check character element existence in a character element space.
                if ($(this).find(".draggable").length) {
                  //get character data from a characterElement

                  //get class name of a characterElement
                  className = $(Element)
                    .text()
                    .match(/\(([^)]+)\)/)[1]
                    .split(" ")[0]
                    .trim();
                  //get other data of characterElement using className
                  var color = getColorForClass(className);
                  var synergy = getSynergyForClass(className);
                  var shortSyn = getShortSynergyForClass(className);
                  var itemLevel = Number(
                    $(Element)
                      .text()
                      .split("(")[1]
                      .replace(/[^0-9.-]+/g, "")
                  );

                  //add unique data in a party from each character element
                  color.forEach(function (item, index) {
                    uniColor.push(item);
                  });
                  synergy.forEach(function (item, index) {
                    uniSynergy.push(item);
                  });

                  totalItemLevel += itemLevel;
                  itemCount++;
                }
              });

            uniSynergy.forEach(function (item, index) {
              uniShortSyn.push(
                item
                  .split("-")[0]
                  .split(" ")
                  .map((word) => word.charAt(0).toUpperCase())
                  .join("")
              );
            });

            //rearrange uniData synergy in Korean alphabetical order
            for (var i = 0; i < uniColor.length; i++) {
              var data = {
                color: uniColor[i],
                shortSyn: uniShortSyn[i],
                synergy: uniSynergy[i],
              };
              uniData.push(data);
            }

            uniData.sort(function (a, b) {
              var synergyA = a.synergy.toUpperCase();
              var synergyB = b.synergy.toUpperCase();
              if (synergyA < synergyB) {
                return -1;
              }
              if (synergyA > synergyB) {
                return 1;
              }
              return 0;
            });

            //make colorCircles with tooltip
            $(this).find(".colorCircles").remove();
            var colorCircles = $("<div></div>")
              .addClass("colorCircles")
              .attr({ width: "100%" });
            var prevSynergy = "";
            for (var i = 0; i < Object.keys(uniData).length; i++) {
              if (
                uniData[i].synergy.split("-")[0] != prevSynergy.split("-")[0]
              ) {
                counter = 0;
              }
              counter++;
              var colorCircle = $("<span></span>")
                .addClass("rounded-rectangle")
                .css("background-color", uniData[i].color);
              colorCircle.text(uniData[i].shortSyn);
              colorCircle
                .attr({
                  "data-toggle": "tooltip",
                  "data-placement": "bottom",
                  title: uniData[i].synergy,
                })
                .tooltip();
              // add '/' between colorCircles with successive same synergy
              if (
                i > 0 &&
                uniData[i].synergy.split("-")[0] != prevSynergy.split("-")[0]
              ) {
                colorCircles.append("<span> / </span>");
              }
              colorCircles.append(colorCircle);
              prevSynergy = uniData[i].synergy;
            }

            //display party data except character data
            var numSlash = colorCircles.text().split("/").length - 1;
            //avgItemLevel data
            var avgItemLevel =
              itemCount > 0 ? (totalItemLevel / itemCount).toFixed(1) : 0;
            $(this)
              .find(".avg-item-level")
              .text(" 평균템렙:" + avgItemLevel);
            //synergy number data
            if (numSlash == 0 && Object.keys(uniData).length == 0) {
              $(this)
                .find(".color-count")
                .text(
                  " 시너지수:" +
                    Object.keys(uniData).length +
                    " (" +
                    numSlash +
                    ")"
                );
            } else if (numSlash == 0 && Object.keys(uniData).length != 0) {
              numSlash++;
              $(this)
                .find(".color-count")
                .text(
                  " 시너지수:" +
                    Object.keys(uniData).length +
                    " (" +
                    numSlash +
                    ")"
                );
            } else {
              numSlash++;
              $(this)
                .find(".color-count")
                .text(
                  " 시너지수:" +
                    Object.keys(uniData).length +
                    " (" +
                    numSlash +
                    ")"
                );
            }
            //color circles
            $(this).find(".color-count").after(colorCircles);
          });
        }

        // Add event listeners to copy buttons
        $("#class-copyBtn").click(function () {
          var containerId = $(this).closest(".to-container").attr("id");
          var dataElement = $("#" + containerId + " .grouping-columns");
					openBar();
          copyData(dataElement);
        });

        // Add event listeners to save buttons
        $("#class-saveBtn").click(function () {
          var containerId = $(this).closest(".to-container").attr("id");
          var dataElement = $("#" + containerId + " .grouping-columns");
          saveData(dataElement);
        });

        // Function to copy the content of an element as JSON or CSV
        function copyData(element) {
					var json = convertToJSON(element);
					navigator.clipboard.writeText(json).then(function () {
            alert("클립보드에 복사되었습니다.");
          });
        }

        // Function to save the content of an element as JSON or CSV
        function saveData(element) {
          var json = convertToJSON(element);
          var csv = convertToCSV(json);

          var link = document.createElement("a");
          link.href = "data:text/csv;charset=utf-8," + encodeURI(csv);
          link.download = "data.csv";
          link.click();
        }
        
        // Function to convert the content of an element to JSON format
        function convertToJSON(group) {
          //get party columns css object from grouping column.
          party = $(group).find(".party-column");

          //prepare object to store grouping column data.
          groupData = {};

          //get text data from each party column objects.
          party.each(function (partyIndex, partyElement) {
            //get objects of each data element from party column.
            classElements = $(partyElement).find(".draggable");
            partySynNumElement = $(partyElement).find(".color-count");
            partySynElements = $(partyElement).find(
              ".party-synergy .rounded-rectangle"
            );

            //set partyName
            partyName = partyIndex + 1 + "파티";
            console.log("partyName:" + partyName);

            //get data of partySynNum
            partySynNumText = partySynNumElement.text();
            regex = /\d+/g;
            partySynNum = partySynNumText.match(regex);
            console.log("partySynNum:" + partySynNum);

            //prepare partySynArray to store partySyn data.
            partySynArray = [];

            //get data of partySyn
            partySynElements.each(function (partysynIndex, partySynElement) {
              //get data of each partySyns
              partySynName = partySynElement.innerText;

              //store data to partySynArray
              partySynArray.push(partySynName);
            });
						//store party data in groupdata
            groupData["Party" + (partyIndex + 1) + "Synergy"] = partySynArray;
            groupData["Party" + (partyIndex + 1) + "SynNum"] = partySynNum;
            console.log(groupData);

						//get each data of class
            partyArray = [];
            if (classElements.length) {
              classElements.each(function (classIndex, classElement) {
                className = classElement.innerText.split("\n")[0];
                console.log("className:" + className);

                classSynergyWraper = $(classElement).find(".class-synergy");
                classSynergyElements = classSynergyWraper.children();
                synergyArray = [];
                
                //get each data of class synergy 
                classSynergyElements.each(function (
                  synergyIndex,
                  synergyElement
                ) {
                  synergyName = synergyElement.innerText;
                  console.log("synergyName:" + synergyName);
                  synergyArray[synergyIndex] = synergyName;
                });
								//store each class&synergy data in partyArray
                partyArray.push({ Class: className, Synergy: synergyArray });
              });
            }
						//store each partyArray data in groupdata
            groupData["Party" + (partyIndex + 1)] = partyArray;
          });
					//send groupdata as string
          console.log("test:" + JSON.stringify(groupData));
          return JSON.stringify(groupData);
        }

        function convertToTable(table) {
          console.log("initiated");
          //get table data from clipboard
          navigator.clipboard.readText().then((data) => {
            //parse JSON 
            const jsonData = JSON.parse(data);
            //extract data from JSON
            var newData = [];
            newData.push(["1파티", "파티시너지수", "파티시너지"]);
            newData.push([
              "",
              jsonData.Party1SynNum.join(","),
              jsonData.Party1Synergy.join(","),
            ]);
            newData.push(["", "직업", "시너지"]);

            jsonData.Party1.forEach(function (party) {
              newData.push(["", party.Class, party.Synergy.join(",")]);
            });
            console.log(jsonData.Party1SynNum);
            newData.push(["2파티", "파티시너지수", "파티시너지"]);
            newData.push([
              "",
              jsonData.Party2SynNum.join(","),
              jsonData.Party2Synergy.join(","),
            ]);
            newData.push(["", "직업", "시너지"]);

            jsonData.Party2.forEach(function (party) {
              newData.push(["", party.Class, party.Synergy.join(",")]);
            });

            // Initialize Handsontable

            //prepare table data
            var container = document.getElementById("spreadsheet");
            existingData = [];
            existingData = table.getData();            
            sumData = [];
						var countDataRows = table.countRows() - table.countEmptyRows();
            //when table have no data
            if(countDataRows==0)
            {
              console.log("empty table");
              sumData = [].concat(newData);
              console.log(sumData);
            }
            //when table have data
            else if(countDataRows>0)
            {
              
              console.log("not empty table");
              sumData = existingData.slice(0,countDataRows).concat(newData);
              console.log(sumData);
            }

	    var newBeginIndex = countDataRows;
            table.updateSettings({
              data: sumData,
              minRows: 10,
              minCols: 10,
              width: "100%",
              mergeCells: [
                {row: newBeginIndex+0, col:0, rowspan: (3+jsonData.Party1.length), colspan: 1},
                {row: newBeginIndex+(3+jsonData.Party1.length), col:0, rowspan: (3+jsonData.Party2.length), colspan: 1}
                ],
              rowHeaders: true,
              colHeaders: true,
              contextMenu: true,
              licenseKey: "non-commercial-and-evaluation",
              
            });

            //set table header background color.
            
            //party1
            table.setCellMeta(newBeginIndex+0,0,'className','main-header');
            //party1 attribute
            table.setCellMeta(newBeginIndex+0,1,'className','sub-header');
            table.setCellMeta(newBeginIndex+0,2,'className','sub-header');
            //character attribute
            table.setCellMeta(newBeginIndex+2,1,'className','sub-header');
            table.setCellMeta(newBeginIndex+2,2,'className','sub-header');

            //party2
            table.setCellMeta(newBeginIndex+(3+jsonData.Party1.length)+0,0,'className','main-header');
            //party2 attribute
            table.setCellMeta(newBeginIndex+(3+jsonData.Party1.length)+0,1,'className','sub-header');
            table.setCellMeta(newBeginIndex+(3+jsonData.Party1.length)+0,2,'className','sub-header');
            //character attribute
            table.setCellMeta(newBeginIndex+(3+jsonData.Party1.length)+2,1,'className','sub-header');
            table.setCellMeta(newBeginIndex+(3+jsonData.Party1.length)+2,2,'className','sub-header');

            
            //render table
            table.render();
  
          });
        }

            // Initialize Handsontable
            var container = document.getElementById("spreadsheet");
            var hot = new Handsontable(container, {
              width: "100%",
              startRows: 10,
              startCols: 10,
              rowHeaders: true,
              colHeaders: true,
              contextMenu: true,
              licenseKey: "non-commercial-and-evaluation",
            });

            hot.render();
      
        // Attach event listener to the paste button
        const pasteButton = document.getElementById("paste-button");
        pasteButton.addEventListener("click", function(){
          convertToTable(hot);
        });
      });
      
        function openBar() {
          document.getElementById("table-sidebar").style.width = "66%";
          document.getElementById("table-sidebar").style.paddingRight = "2%"
          document.getElementById("sideOpenBtn").style.width = "0%";
        
        }

        /* Set the width of the side navigation to 0 */
        function closeBar() {
          document.getElementById("table-sidebar").style.width = "0";
          document.getElementById("table-sidebar").style.paddingRight = "0"
          document.getElementById("sideOpenBtn").style.width = "30px";
        }
    </script>
  </body>
</html>
